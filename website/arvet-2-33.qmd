---
title: "ARVET Batch registra campioni"
---

## Usa l'App Online

L'applicazione è disponibile online e può essere utilizzata direttamente dal browser:

<iframe src="https://vesco.shinyapps.io/arvet-2-33/" width="100%" height="800px" style="border: 1px solid #ccc; border-radius: 4px;"></iframe>

---

## Applicazione per l'Inserimento Dati su ARVET

Questa applicazione permette di preparare i dati per l'inserimento della corrispondenza tra numero campione e contrassegno sulla pagina [ARVET campionamenti](https://arvet.reteunitaria.piemonte.it/campionamenti) da un file Excel (.xlsx).

### Funzionalità

L'applicazione consente di:

- **Caricare un file Excel** con i dati di provette e contrassegni
- **Selezionare le colonne** corrette dal file caricato
- **Validare automaticamente** i dati:
  - Verifica che le provette siano numeri interi positivi (≥ 1)
  - Controlla che non ci siano numeri mancanti nella sequenza 1..N
  - Verifica che non ci siano duplicati
  - Se ci sono errori, li elenca in modo dettagliato
- **Esportare un CSV** nel formato richiesto dalle macro Ui.Vision (quando il file è corretto)

### Flusso di Lavoro

1. **I numeri di provette** sono riportati su un file Excel in una colonna apposita
2. **L'app verifica** che non ci siano:
   - Duplicati
   - Numeri mancanti
   - Numeri che non sono interi positivi
3. **Se ci sono errori**, l'app li elenca
4. **Quando il file è corretto**, genera un file .csv pronto da essere utilizzato nella macro Ui.Vision

### Come Utilizzare l'App

1. **Carica il tuo file Excel**:
   - Clicca su "Seleziona file .xlsx (dal tuo PC)"
   - Scegli il file Excel contenente i dati delle provette

2. **Seleziona le colonne**:
   - **Colonna 'provetta'**: La colonna con i numeri delle provette
   - **Colonna 'contrassegno'**: La colonna con i contrassegni degli animali
   - L'app seleziona automaticamente la prima colonna per 'provetta' e la seconda per 'contrassegno'

3. **Verifica i controlli**:
   - L'app mostra un riepilogo dei dati caricati
   - Vengono effettuati controlli automatici
   - Se ci sono errori, vengono elencati tutti i valori mancanti o duplicati

4. **Esporta il CSV**:
   - Se tutti i controlli sono superati, appare il pulsante "Esporta CSV"
   - Clicca per scaricare il file `provette.csv`

5. **Importa in Ui.Vision**:
   - Apri la finestra dell'estensione Ui.Vision
   - Vai al tab **CSV** nella parte bassa
   - Clicca **"Import CSV"** e seleziona il file scaricato

### Formato del CSV Generato

Il file CSV prodotto ha il seguente formato:

```
1,IT123456789012
2,IT234567890123
3,IT345678901234
...
```

Caratteristiche:
- Due colonne: numero provetta (intero) e contrassegno
- Nessuna intestazione
- Valori separati da virgola
- Solo righe complete (senza valori mancanti)

### Esempio di Utilizzo

**File Excel di Input:**

| Provetta | Contrassegno | Altre colonne... |
|----------|--------------|------------------|
| 1 | IT123456789012 | ... |
| 2 | IT234567890123 | ... |
| 3 | IT345678901234 | ... |

**File CSV di Output:**

```
1,IT123456789012
2,IT234567890123
3,IT345678901234
```

### Controlli Eseguiti dall'App

L'applicazione esegue i seguenti controlli:

1. **Validità dei Valori**: Tutti i valori devono essere numeri interi ≥ 1
2. **Sequenza Completa**: Se il massimo valore è N, devono esistere tutti i valori da 1 a N
3. **Assenza di Duplicati**: Ogni numero di provetta deve apparire una sola volta
4. **Colonne Distinte**: Le colonne 'provetta' e 'contrassegno' devono essere diverse

### Workflow Completo

Per utilizzare l'applicazione con le macro Ui.Vision:

1. **Prepara i dati Excel**: Assicurati che il file contenga colonne per provette e contrassegni
2. **Usa l'app online**: Carica ed esporta il CSV validato
3. **Importa il CSV in Ui.Vision**: Usa il tab CSV e il tasto "Import CSV"
4. **Esegui la macro**: Usa la macro appropriata (bovini o ovicaprini) sulla pagina [ARVET campionamenti](https://arvet.reteunitaria.piemonte.it/campionamenti)

### Link Utili

- [Macro Ui.Vision](uivision.qmd) per le istruzioni sulle macro
- [Risoluzione Problemi](troubleshooting.qmd) per aiuto con errori comuni
- [Uso Locale](uso-locale.qmd) per eseguire l'app sul tuo computer
