---
title: "ARVET Batch registra campioni"
---

::: {.callout-tip}
## Link Utili
- [Installazione e Configurazione](installazione.qmd) - Come installare Ui.Vision e configurare l'ambiente
- [Uso Locale](uso-locale.qmd) - Come eseguire l'app sul tuo computer
- [Risoluzione Problemi](troubleshooting.qmd) - Aiuto per errori comuni
:::


## Flusso di lavoro completo

Per utilizzare l'applicazione con le macro Ui.Vision:

1. **Prepara i dati Excel**: Assicurati che il file .xlsx contenga colonne per provette e contrassegni
2. **Usa l'app**: Carica ed esporta il CSV validato (possibilmente in Desktop/uivision/datasources)
3. **Importa il CSV in Ui.Vision**: Usa il tab CSV in UI.Vision e il tasto "Import CSV"
4. **Esegui la macro**: Usa la macro appropriata (bovini o ovicaprini) sulla pagina [ARVET campionamenti](https://arvet.reteunitaria.piemonte.it/campionamenti)

## Usa l'App per la trasformazione del file .xlsx in csv compatibile con UI.Vision

L'applicazione è disponibile online ma, se si dispone localmente di un setup funzionante, di eseguirla localmente:  

- [Eseguire l'applicazione online](https://vesco.shinyapps.io/arvet-2-33/)  
- [istruzioni per l'uso locale](uso-locale.qmd).

### Funzionalità

Questa applicazione permette di preparare i dati per l'inserimento della corrispondenza tra numero campione e contrassegno sulla pagina [ARVET campionamenti](https://arvet.reteunitaria.piemonte.it/campionamenti) da un file Excel (.xlsx).

#### Passi

L'applicazione consente di:

- **Caricare un file Excel** con i dati di provette e contrassegni
- **Selezionare le colonne** corrette dal file caricato
- **Validare automaticamente** i dati:
  - Verifica che le provette siano numeri interi positivi (≥ 1)
  - Controlla che non ci siano numeri mancanti nella sequenza 1..N
  - Verifica che non ci siano duplicati
  - Se ci sono errori, li elenca in modo dettagliato
- **Esportare un CSV** nel formato richiesto dalle macro Ui.Vision (quando il file è corretto)

##### Controlli Eseguiti dall'App

L'applicazione esegue i seguenti controlli:

1. **Validità dei Valori**: Tutti i valori devono essere numeri interi ≥ 1
2. **Sequenza Completa**: Se il massimo valore è N, devono esistere tutti i valori da 1 a N
3. **Assenza di Duplicati**: Ogni numero di provetta deve apparire una sola volta
4. **Colonne Distinte**: Le colonne 'provetta' e 'contrassegno' devono essere diverse

#### Flusso di Lavoro

1. **I numeri di provette** sono riportati su un file Excel in una colonna apposita
2. **L'app verifica** che non ci siano:
   - Duplicati
   - Numeri mancanti
   - Numeri che non sono interi positivi
3. **Se ci sono errori**, l'app li elenca
4. **Quando il file è corretto**, genera un file .csv pronto da essere utilizzato nella macro Ui.Vision

### Come Utilizzare l'App

1. **Carica il tuo file Excel**:
   - Clicca su "Seleziona file .xlsx (dal tuo PC)"
   - Scegli il file Excel contenente i dati delle provette

2. **Seleziona le colonne**:
   - **Colonna 'provetta'**: La colonna con i numeri delle provette
   - **Colonna 'contrassegno'**: La colonna con i contrassegni degli animali
   - L'app seleziona automaticamente la prima colonna per 'provetta' e la seconda per 'contrassegno'

3. **Verifica i controlli**:
   - L'app mostra un riepilogo dei dati caricati
   - Vengono effettuati controlli automatici
   - Se ci sono errori, vengono elencati tutti i valori mancanti o duplicati

4. **Esporta il CSV**:
   - Se tutti i controlli sono superati, appare il pulsante "Esporta CSV"
   - Clicca per scaricare il file `provette.csv`

5. **Importa in Ui.Vision**:
   - Apri la finestra dell'estensione Ui.Vision
   - Vai al tab **CSV** nella parte bassa
   - Clicca **"Import CSV"** e seleziona il file scaricato

### Formato del CSV Generato

Il file CSV prodotto ha il seguente formato:

```
1,IT123456789012
2,IT234567890123
3,IT345678901234
...
```

Caratteristiche:
- Due colonne: numero provetta (intero) e contrassegno
- Nessuna intestazione
- Valori separati da virgola
- Solo righe complete (senza valori mancanti)

### Esempio di Utilizzo

**File Excel di Input:**

| Provetta | Contrassegno | Altre colonne... |
|----------|--------------|------------------|
| 1 | IT123456789012 | ... |
| 2 | IT234567890123 | ... |
| 3 | IT345678901234 | ... |

**File CSV di Output:**

```
1,IT123456789012
2,IT234567890123
3,IT345678901234
```




### Link Utili

- [Macro Ui.Vision](uivision.qmd) per le istruzioni sulle macro
- [Risoluzione Problemi](troubleshooting.qmd) per aiuto con errori comuni
- [Uso Locale](uso-locale.qmd) per eseguire l'app sul tuo computer
